---
# Dependabot configuration
#
# This file configures automated dependency updates.
# The goal is to:
#  - keep dependencies up to date without noise
#  - separate development and runtime (production) dependencies for safer review
#  - reduce the number of PRs by batching minor and patch updates
#  - highlight potentially breaking (major) updates in dedicated PRs
#
# Recommended documentation:
#
# 1) Dependabot Options Reference — full list of available keys,
#    including "dependency-type", "groups", "update-types", etc.
#    https://docs.github.com/en/code-security/dependabot/dependabot-version-updates/configuration-options-for-the-dependabot.yml-file
#
# 2) Optimizing pull request creation — best practices for grouping updates,
#    controlling frequency, and limiting noise in development teams.
#    https://docs.github.com/en/code-security/dependabot/dependabot-version-updates/optimizing-pr-creation-version-updates
#
# These links explain *why* we split dev/prod dependencies,
# *how* grouping works, and what update strategies GitHub recommends
# for real-world projects.
#
version: 2
updates:
  # 1) Dev dependencies: tools only (lint, tests, build, etc.)
  - package-ecosystem: npm
    directory: /
    schedule:
      interval: weekly  # Weekly check for npm devDependencies
    allow:
      # Only dependencies from "devDependencies" in package.json
      - dependency-type: development
    labels: [dependencies, automated, dev]
    commit-message:
      prefix: "chore"
      include: "scope"
    groups:
      npm-dev-minor-patch:
        # Group dev minor + patch updates to reduce PR noise
        update-types: [minor, patch]
      npm-dev-major:
        # Keep major dev updates separate so they can be tested carefully
        update-types: [major]

  # 2) Runtime / production dependencies used by Fastify application
  #    This includes @fastify plugins, pug, yup, sqlite3, etc.
  - package-ecosystem: npm
    directory: /
    schedule:
      interval: weekly  # Weekly check for npm runtime deps
    allow:
      # Only dependencies from "dependencies" in package.json
      - dependency-type: production
    labels: [dependencies, automated, prod]
    commit-message:
      prefix: "chore"
      include: "scope"
    open-pull-requests-limit: 10
    groups:
      npm-runtime-minor-patch:
        # Group non-breaking runtime updates together (safer to merge)
        # Examples: @fastify/view 11.1.1 → 11.2.0, pug 3.0.3 → 3.0.4
        update-types: [minor, patch]
      npm-runtime-major:
        # Major runtime updates in separate PRs (may contain breaking changes)
        # Examples: fastify 5.x.x → 6.0.0, yup 1.x.x → 2.0.0
        # These require careful review and testing before merging
        update-types: [major]